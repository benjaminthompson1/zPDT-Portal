<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>zPDT Portal — Mainframe Home</title>
  <link rel="icon" href="https://www.ibm.com/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:Arial,Helvetica,sans-serif;line-height:1.5;color:#161616;background:#f4f4f4;scroll-behavior:smooth}
    body{padding-top:60px}
    .navbar{position:fixed;top:0;left:0;width:100%;background:#0f62fe;color:#fff;display:flex;align-items:center;justify-content:space-between;padding:12px 24px;z-index:1000}
    .navbar h1{font-size:18px;font-weight:600;display:flex;align-items:center;gap:8px}
    .navbar nav{display:flex;align-items:center}
    .navbar nav a{color:#fff;text-decoration:none;margin-left:20px;font-weight:600;font-size:14px}
    .navbar nav a[aria-current="true"]{text-decoration:underline}
    .navbar nav a:hover{text-decoration:underline}
    .hamburger{display:none;flex-direction:column;cursor:pointer}
    .hamburger span{height:3px;width:20px;background:#fff;margin:3px 0;border-radius:2px}
    @media(max-width:700px){
      .navbar nav{display:none;flex-direction:column;background:#0f62fe;position:absolute;top:50px;right:0;width:200px}
      .navbar nav.show{display:flex}
      .hamburger{display:flex}
      .navbar nav a{margin:12px}
    }
    .container{width:100%;max-width:1080px;margin:0 auto;padding:32px;background:#fff;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.1)}
    header{border-bottom:2px solid #e0e0e0;padding-bottom:16px;margin-bottom:20px}
    .brand h2{font-size:20px;font-weight:600;color:#0f62fe}
    p.lead{color:#525252;font-size:15px;margin-top:4px}
    .actions{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:24px}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 16px;border-radius:4px;text-decoration:none;font-weight:600;font-size:14px;transition:background .2s}
    .btn--primary{background:#0f62fe;color:#fff}
    .btn--primary:hover{background:#0043ce}
    .btn--muted{background:#e0e0e0;color:#161616}
    .btn--muted:hover{background:#c6c6c6}
    section{margin-bottom:36px}
    section h3{margin-bottom:16px;font-size:18px;color:#0f62fe;border-bottom:1px solid #e0e0e0;padding-bottom:4px}
    .back-top{text-align:right;margin-top:10px}
    .back-top a{font-size:12px;color:#0f62fe;text-decoration:none}
    .back-top a:hover{text-decoration:underline}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
    .card{padding:16px;border:1px solid #e0e0e0;border-radius:6px;background:#fff;transition:box-shadow .2s;position:relative}
    .card:hover{box-shadow:0 2px 8px rgba(0,0,0,0.08)}
    .card h4{margin-bottom:6px;font-size:16px;color:#0f62fe}
    .card p{margin:0;font-size:14px;color:#525252}
    .card a{display:inline-block;margin-top:10px;font-weight:600;text-decoration:none;color:#0f62fe;font-size:14px}
    .card a:hover{text-decoration:underline}
    .card i{margin-right:6px}
    .status{position:absolute;top:10px;right:10px;height:12px;width:12px;border-radius:50%;background:#bbb}
    .status.up{background:#24a148}
    .status.down{background:#da1e28}
    .status.loading{background:#0f62fe;animation:pulse 1.5s infinite}
    .status.unknown{background:#f1c21b}
    footer{margin-top:28px;border-top:1px solid #e0e0e0;padding-top:12px;font-size:12px;color:#6f6f6f;text-align:center}
    
    /* GitLab styling */
    .gitlab-card { border-left: 4px solid #fc6d26; }
    .github-card { border-left: 4px solid #333; }
    
    /* Pulse animation for loading */
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.4; }
      100% { opacity: 1; }
    }
    
    /* Error notification styling */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 12px 20px;
      border-radius: 4px;
      color: white;
      font-weight: 600;
      z-index: 1001;
      transform: translateX(120%);
      transition: transform 0.3s ease-in-out;
    }
    .notification.show {
      transform: translateX(0);
    }
    .notification.error {
      background: #da1e28;
    }
    .notification.success {
      background: #24a148;
    }
  </style>
</head>
<body>
  <div class="navbar">
    <h1><i class="fas fa-server" aria-hidden="true"></i> zPDT Portal</h1>
    <div class="hamburger" id="hamburger" aria-label="Toggle navigation menu" role="button" tabindex="0">
      <span></span><span></span><span></span>
    </div>
    <nav id="nav">
      <a href="#system">System Management</a>
      <a href="#docs">Documentation & Reference</a>
      <a href="#tools">Tools</a>
      <a href="#repos">Repositories</a>
    </nav>
  </div>

  <div class="container" role="main">
    <header>
      <div class="brand">
        <h2>zPDT — Personal Mainframe Landing</h2>
        <p class="lead">Your single place to reach z/OSMF, Zowe, QWT, and documentation for your zPDT environment.</p>
      </div>
    </header>

    <div class="actions" aria-label="Quick actions">
      <a class="btn btn--primary" href="#system">Go to System Management</a>
      <a class="btn btn--muted" href="#docs">Go to Documentation</a>
      <a class="btn btn--muted" href="#tools">Go to Tools</a>
      <a class="btn btn--muted" href="#repos">Go to Repositories</a>
    </div>

    <!-- SYSTEM MANAGEMENT -->
    <section id="system">
      <h3>System Management</h3>
      <div class="grid">
        <div class="card">
          <span class="status loading" id="zosmf-status" title="Checking status..."></span>
          <h4><i class="fas fa-cogs"></i> z/OSMF</h4>
          <p>Web-based management for z/OS. Use this for system tasks, workflows, and REST APIs.</p>
          <a href="https://s0w1.dal-ebis.ihost.com:10443/zosmf/LogOnPanel.jsp" target="_blank" rel="noopener noreferrer">Open z/OSMF</a>
        </div>
        <div class="card">
          <span class="status loading" id="zowe-status" title="Checking status..."></span>
          <h4><i class="fas fa-plug"></i> Zowe</h4>
          <p>Web UI and API gateway for mainframe tools. Helpful for file browsing, CLI, and extensions.</p>
          <a href="https://s0w1.dal-ebis.ihost.com:7554/zlux/ui/v1/ZLUX/plugins/org.zowe.zlux.bootstrap/web/" target="_blank" rel="noopener noreferrer">Open Zowe</a>
        </div>
        <div class="card">
          <span class="status loading" id="qwt-status" title="Checking status..."></span>
          <h4><i class="fas fa-chart-line"></i> Db2 Query Workload Tuner</h4>
          <p>Tune and analyze Db2 workloads through the interactive Swagger UI.</p>
          <a href="https://s0w1.dal-ebis.ihost.com:11002/tuningservice/v1/swagger-ui/index.html" target="_blank" rel="noopener noreferrer">Open QWT Swagger UI</a>
        </div>
        <div class="card">
          <span class="status loading" id="debugger-status" title="Checking status..."></span>
          <h4><i class="fas fa-bug"></i> z/OS Debugger</h4>
          <p>Interactive debugging tool for COBOL, PL/I, Assembler, and other mainframe languages.</p>
          <a href="http://192.168.1.171:8143/profile-management/" target="_blank" rel="noopener noreferrer">Open z/OS Debugger</a>
        </div>
        <div class="card">
          <span class="status loading" id="mfa-status" title="Checking status..."></span>
          <h4><i class="fas fa-shield-alt"></i> IBM MFA TOTP</h4>
          <p>Time-based one-time password factor for IBM Multi-Factor Authentication.</p>
          <a href="https://s0w1.dal-ebis.ihost.com:6793/AZFTOTP1/genericStart" target="_blank" rel="noopener noreferrer">Open IBM MFA TOTP</a>
        </div>
      </div>
      <div class="back-top"><a href="#">Back to top ↑</a></div>
    </section>

    <!-- DOCUMENTATION & REFERENCE -->
    <section id="docs">
      <h3>Documentation & Reference</h3>
      <div class="grid">
        <div class="card">
          <h4><i class="fas fa-book"></i> Playbooks</h4>
          <p>Neale's playbook for Db2 Tools environment on GitHub.</p>
          <a href="https://github.com/zeditor01/zowe_db2_tools/tree/main" target="_blank" rel="noopener noreferrer">Open Db2 Tools Playbook</a>
        </div>
        <div class="card">
          <h4><i class="fab fa-github"></i> JCL Library</h4>
          <p>Sample and production JCL jobs stored centrally for easy reference.</p>
          <a href="https://github.com/benjaminthompson1/JCL" target="_blank" rel="noopener noreferrer">Open JCL Library</a>
        </div>
        <div class="card">
          <h4><i class="fas fa-book-open"></i> IBM Docs</h4>
          <p>Access IBM Knowledge Center for z/OS 3.1 and Db2 13.</p>
          <a href="https://www.ibm.com/docs/en/zos/3.1.0" target="_blank" rel="noopener noreferrer">Open z/OS 3.1 Docs</a><br>
          <a href="https://www.ibm.com/docs/en/db2-for-zos/13" target="_blank" rel="noopener noreferrer">Open Db2 13 Docs</a>
        </div>
        <div class="card">
          <h4><i class="fas fa-book-reader"></i> IBM Redbooks</h4>
          <p>Access IBM Redbooks for guidance, best practices, and implementation tips.</p>
          <a href="https://www.redbooks.ibm.com/" target="_blank" rel="noopener noreferrer">Open IBM Redbooks</a>
        </div>
        <div class="card">
          <h4><i class="fas fa-life-ring"></i> IBM Support</h4>
          <p>Access IBM Support for case management, downloads, and technical assistance.</p>
          <a href="https://www.ibm.com/mysupport/s/?language=en_US" target="_blank" rel="noopener noreferrer">Open IBM Support</a>
        </div>
        <div class="card">
          <h4><i class="fab fa-gitlab"></i> GitLab Documentation</h4>
          <p>Official GitLab documentation for installation, configuration, and usage.</p>
          <a href="https://docs.gitlab.com/" target="_blank" rel="noopener noreferrer">Open GitLab Docs</a>
        </div>
      </div>
      <div class="back-top"><a href="#">Back to top ↑</a></div>
    </section>

    <!-- TOOLS -->
    <section id="tools">
      <h3>Tools</h3>
      <div class="grid">
        <div class="card">
          <span class="status loading" id="guac-status" title="Checking status..."></span>
          <h4><i class="fas fa-desktop"></i> Apache Guacamole</h4>
          <p>Remote desktop gateway (browser-based) for accessing systems like SSH, RDP, VNC, etc.</p>
          <a href="https://guac.mainframehome.net/#/" target="_blank" rel="noopener noreferrer">Open Guacamole</a>
        </div>
      </div>
      <div class="back-top"><a href="#">Back to top ↑</a></div>
    </section>

    <!-- REPOSITORIES -->
    <section id="repos">
      <h3>Repositories</h3>
      <div class="grid">
        <div class="card gitlab-card">
          <h4><i class="fab fa-gitlab"></i> Local GitLab Instance</h4>
          <p>Access your local GitLab instance for mainframe development projects.</p>
          <a href="http://192.168.1.165.nip.io/" target="_blank" rel="noopener noreferrer">Open Local GitLab</a>
        </div>
        <div class="card github-card">
          <h4><i class="fab fa-github"></i> GitHub Profile</h4>
          <p>View Benjamin Thompson's public repositories and contributions.</p>
          <a href="https://github.com/benjaminthompson1" target="_blank" rel="noopener noreferrer">Open GitHub Profile</a>
        </div>
      </div>
      <div class="back-top"><a href="#">Back to top ↑</a></div>
    </section>

    <footer>
      <p id="last-updated"></p>
      <p>Maintained by Benjamin Thompson | Powered by IBM z/OS Liberty</p>
    </footer>
  </div>

  <!-- Notification container -->
  <div id="notification-container"></div>

  <script>
    // Global error handling
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.error);
      // Don't show notification for status check errors to avoid spam
      if (!e.filename || !e.filename.includes('status')) {
        showNotification('An unexpected error occurred. Please try again.', 'error');
      }
    });

    // Promise rejection handling
    window.addEventListener('unhandledrejection', function(e) {
      console.error('Unhandled promise rejection:', e.reason);
      // Don't show notification for status check errors to avoid spam
      if (!e.reason.message || !e.reason.message.includes('status')) {
        showNotification('A background operation failed. Please try again.', 'error');
      }
      e.preventDefault();
    });

    const hamburger=document.getElementById("hamburger");
    const nav=document.getElementById("nav");
    hamburger.addEventListener("click",()=>{nav.classList.toggle("show")});
    hamburger.addEventListener("keypress",(e)=>{if(e.key==="Enter"){nav.classList.toggle("show")}});

    const sections=document.querySelectorAll("section");
    const navLinks=document.querySelectorAll(".navbar nav a");
    window.addEventListener("scroll",()=>{
      let current="";
      sections.forEach(section=>{
        const sectionTop=section.offsetTop-70;
        if(scrollY>=sectionTop){current=section.getAttribute("id")}
      });
      navLinks.forEach(link=>{
        link.removeAttribute("aria-current");
        if(link.getAttribute("href")==="#"+current){link.setAttribute("aria-current","true")}
      });
    });

    // Improved service status checking - more lenient approach
    async function checkService(url, id, timeout = 8000) {
      const statusElement = document.getElementById(id);
      statusElement.classList.add('loading');
      statusElement.classList.remove('up', 'down', 'unknown');
      statusElement.title = "Checking status...";

      try {
        // First try a simple HEAD request (faster)
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), timeout);

        const response = await fetch(url, { 
          method: "HEAD",
          mode: "no-cors",
          signal: controller.signal
        });
        
        clearTimeout(timeoutId);
        
        // With no-cors mode, we can't read the response details
        // But if the request doesn't throw an error, the service is likely reachable
        statusElement.classList.remove('loading');
        statusElement.classList.add("up");
        statusElement.title = "Service appears to be reachable";
        
      } catch (err) {
        // If HEAD fails, try GET with no-cors (still limited info due to CORS)
        try {
          const controller = new AbortController();
          const timeoutId = setTimeout(() => controller.abort(), timeout);

          const response = await fetch(url, { 
            method: "GET",
            mode: "no-cors",
            signal: controller.signal
          });
          
          clearTimeout(timeoutId);
          
          statusElement.classList.remove('loading');
          statusElement.classList.add("up");
          statusElement.title = "Service appears to be reachable";
          
        } catch (err2) {
          statusElement.classList.remove('loading');
          
          if (err2.name === 'AbortError' || err.name === 'AbortError') {
            statusElement.classList.add("unknown");
            statusElement.title = "Check timed out - service may be slow or unreachable";
          } else {
            statusElement.classList.add("unknown");
            statusElement.title = "Unable to determine status - service may require authentication";
          }
        }
      }
    }

    // Notification system
    function showNotification(message, type = 'success') {
      const container = document.getElementById('notification-container');
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      
      container.appendChild(notification);
      
      // Trigger reflow to enable transition
      notification.offsetHeight;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }

    // Check all services with a slight delay between each to avoid overwhelming the browser
    function checkAllServices() {
      const services = [
        {url: "https://s0w1.dal-ebis.ihost.com:10443/zosmf/LogOnPanel.jsp", id: "zosmf-status"},
        {url: "https://s0w1.dal-ebis.ihost.com:7554/zlux/ui/v1/ZLUX/plugins/org.zowe.zlux.bootstrap/web/", id: "zowe-status"},
        {url: "https://s0w1.dal-ebis.ihost.com:11002/tuningservice/v1/swagger-ui/index.html", id: "qwt-status"},
        {url: "http://192.168.1.171:8143/profile-management/", id: "debugger-status"},
        {url: "https://s0w1.dal-ebis.ihost.com:6793/AZFTOTP1/genericStart", id: "mfa-status"},
        {url: "https://guac.mainframehome.net/#/", id: "guac-status"}
      ];

      // Check services with staggered timing
      services.forEach((service, index) => {
        setTimeout(() => {
          checkService(service.url, service.id);
        }, index * 500);
      });
    }

    // Run status checks
    checkAllServices();

    document.getElementById("last-updated").textContent="Last updated: "+new Date().toLocaleString();
  </script>
</body>
</html>